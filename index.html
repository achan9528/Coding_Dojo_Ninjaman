<html>
    <head>
        <title>NinjaMan</title>
        <style type="text/css">
            * {
                margin: 0;
                padding: 0;
            }
            .row{
                line-height: 0;
            }
            .wall{
                background-color: black;
                height: 40px;
                width: 40px;
                display: inline-block;
            }
            .sushi{
                background-color: white;
                background-image: url('./img/sushi.png');
                background-repeat: no-repeat;
                background-position: center;
                height: 40px;
                width: 40px;
                display: inline-block;
            }
            .blank{
                background-color: white;
                height: 40px;
                width: 40px;
                display: inline-block;
            }
            .ninja{
                background-color: white;
                background-image:url('./img/ninja.gif');
                height: 40px;
                width: 40px;
                display: inline-block;
                background-size: contain;
            }
            #ninja{
                background-color: white;
                background-image:url('./img/ninja.gif');
                height: 40px;
                width: 40px;
                display: inline-block;
                background-size: contain;
                position: absolute;
            }
            #scoreboard{
                background-color:cadetblue;
                height: 80px;
                width: 440px;
                /* display:inline-block; */
            }
            .scoreinfo{
                width: 50%;
                height: 100%;
                display: inline-block;
                vertical-align:top;
            }
            .life{
                background-image:url('./img/right1.png');
                background-repeat: no-repeat;
                background-position: center;
                height: 100%;
                width: 30%;
                display:inline-block;
                /* vertical-align: top; */
            }
            .score_image{
                width: 48%;
                height: 100%;
                background-image:url('./img/sushi.png');
                background-repeat: no-repeat;
                background-position: center;
                display: inline-block;
                /* vertical-align: top; */
            }
            .score_number{
                width: 48%;
                display: inline-block;
                vertical-align: top;
                text-align: center;
                padding-top: 11%;
                padding-bottom: 11%;
                font:bold;
                font-family: sans-serif;
                font-size:x-large;
                border-color:red;
                border-style:dotted;
            }
            /* #sushi_counter{
                display:inline;
            } */
        </style>

    </head>
    <body>
        <div id='world' class='world'></div>
        <div id = 'ninja' class='ninja'></div>
        <div id='scoreboard'>
            <div id='lives' class = 'scoreinfo' >
                <!-- <div class='life'></div>
                <div class='life'></div>
                <div class='life'></div> -->
            </div><div class = 'scoreinfo'>
                <div id ='sushi_counter' class='score_number'>
                    <p>0</p>
                </div>
                <div class='score_image'></div>
            </div>
        </div>
        <script type='text/javascript'>
            var world = [
                [1,1,1,1,1,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,1,1,1],
                [1,1,1,1,0,0,2,1,1,1,1],
                [1,1,1,1,0,2,0,1,1,1,1],
                [1,1,1,1,2,0,0,1,1,1,1],
                [1,1,1,1,1,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,1,1,1],
            ];
            
            var worldDict = {
                0: 'blank',
                1: 'wall',
                2: 'sushi',
                // 3: 'ninja' // you can do this but you shouldn't because it would mean you
                // would have to rewrite all of the html every single time for the entire world. Rather
                // than do that, you can instead place a ninjaman on top of the map and then it would 
                // simply travel over the world without changing the world itself.
            };

            var ninja = {
                x: 0, // these are multipliers to the pixels
                y: 0,
                sushi: 0,
                lives: 3
            };

            function drawWorld(){
                var row_output = "<div class = 'row'>";
                var col_output = "";
                var output = "";
                for (var i = 0; i < world.length ;i++){
                    for (var n = 0; n < world[i].length; n++){
                        if (worldDict[world[i][n]] == 'ninja'){
                            row_output += "<div class = 'ninja' id = 'ninja'></div>";
                        } else{
                        row_output += "<div class = '" + worldDict[world[i][n]] + "'></div>";
                        }
                    }
                    output += row_output + "</div>";
                    row_output = "<div class = 'row'>";
                }
                document.getElementById('world').innerHTML = output;
            };

            function drawScoreboard(){
                // draws lives section
                var output = ""
                for (var i = 0; i < ninja.lives; i++){
                    output += "<div class = 'life'></div>";
                }
                document.getElementById('lives').innerHTML = output + "</div>";

                // draw count
                document.getElementById('sushi_counter').innerHTML = "<p>" + ninja.sushi + "</p>";;
                
            };

            var foundStart = false;

            function drawNinja(){
                for (var i = 0; i < world.length; i++){
                    for (var n = 0; n < world[i].length; n++){
                        if (world[i][n] == 0){
                            ninja.x = n
                            foundStart = true;
                            break;
                        }
                    }
                    if (foundStart){
                        break;
                    } else {
                        ninja.y += 1;
                    }
                }
                document.getElementById('ninja').style.left = (ninja.x * 40) + "px"
                document.getElementById('ninja').style.top = (ninja.y * 40) + "px"
            };

            document.onkeydown = function(e){    
                // make the ninja walk
                moveDict = {
                    37: 'left',
                    38: 'up',
                    39: 'right',
                    40: 'down'
                };
                var dir = moveDict[e.keyCode];
                
                if (dir == 'left'){
                    if (world[ninja.y][ninja.x - 1] == 0) {
                        ninja.x -= 1;
                        document.getElementById('ninja').style.webkitTransform = "scaleX(-1)";
                    } else if (world[ninja.y][ninja.x - 1] == 2) {
                        ninja.x -= 1;
                        document.getElementById('ninja').style.webkitTransform = "scaleX(-1)";
                        world[ninja.y][ninja.x] = 0;
                        ninja.sushi++;
                    }
                } else if (dir == 'right'){
                    if (world[ninja.y][ninja.x + 1] == 0){
                        ninja.x += 1;
                        document.getElementById('ninja').style.webkitTransform = "scaleX(1)";
                    } else if (world[ninja.y][ninja.x + 1] == 2){
                        ninja.x += 1;
                        document.getElementById('ninja').style.webkitTransform = "scaleX(1)";
                        world[ninja.y][ninja.x] = 0;
                        ninja.sushi++;
                    }
                } else if (dir == 'up'){
                    if (world[ninja.y - 1][ninja.x] == 0){
                        ninja.y -= 1;
                        document.getElementById('ninja').style.transform = "rotate(270deg)";
                    } else if (world[ninja.y - 1][ninja.x] == 2){
                        ninja.y -= 1;
                        document.getElementById('ninja').style.transform = "rotate(270deg)";
                        world[ninja.y][ninja.x] = 0;
                        ninja.sushi++;
                    }
                } else if (dir == 'down'){
                    if (world[ninja.y + 1][ninja.x] == 0){
                        ninja.y += 1;
                        document.getElementById('ninja').style.transform = "rotate(90deg)";
                    } else if (world[ninja.y + 1][ninja.x] == 2){
                        ninja.y += 1;
                        document.getElementById('ninja').style.transform = "rotate(90deg)";
                        world[ninja.y][ninja.x] = 0;
                        ninja.sushi++;
                    }
                };
                document.getElementById('ninja').style.left = (ninja.x * 40) + "px";
                document.getElementById('ninja').style.top = (ninja.y * 40) + "px";
                drawWorld();
                drawScoreboard();
                // drawNinja();
            };
                
            drawWorld();
            drawScoreboard();
            drawNinja();
        </script>
    </body>
</html>